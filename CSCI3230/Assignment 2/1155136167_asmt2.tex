\documentclass[12pt]{article}
\setlength{\headheight}{24pt}
\usepackage[top=1.5in, bottom=1in, left=0.5in, right=0.5in]{geometry}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{mwe} % for blindtext and example-image-a in example
\usepackage{wrapfig}
\usepackage{url}
\graphicspath{{./LoveAiri/Downloads/}}
\begin{document}
\fancypagestyle{firstpage}{%
  \lhead{\textit{\textbf{Name: Lai Man Hin}}}
  \chead{\textit{\textbf{SID: 1155136167}}}
  \rhead{\textit{\textbf{CSCI3230/ESTR3108 Assg2}}}
}
\thispagestyle{firstpage}
CSCI3230 / ESTR3108 2021-22 First Term Assignment 2\\
I declare that the assignment here submitted is original except for source material explicitly acknowledged, and that the same or closely related material has not been previously submitted for another course. I also acknowledge that I am aware of University policy and regulations on honesty in academic work, and
of the disciplinary guidelines and procedures applicable to breaches of such policy and regulations, as contained in the following websites.\\
University Guideline on Academic Honesty:\\
\url{http://www.cuhk.edu.hk/policy/academichonesty/}\\
Faculty of Engineering Guidelines to Academic Honesty:\\
\url{http://www.erg.cuhk.edu.hk/erg-intra/upload/documents/ENGG_Discipline.pdf}\\
Student Name: \textit{\textbf{Lai Man Hin}}\\
Student ID : \textit{\textbf{1155136167}}\\
\begin{wrapfigure}[13]{r}{0.5\textwidth}
\includegraphics[scale=0.5]{CSCI3230Assg2Q1Train}\\
\includegraphics[scale=0.5]{CSCI3230Assg2Q1Test}
\end{wrapfigure}
1a) The optimization problem is \\$\max_{\alpha}\bigg[ \sum_{i=1}^{8} \alpha_{i} - \frac{1}{2}\sum_{i=1}^{8}\sum_{j=1}^{8}\alpha_{i}\alpha_{j}y_{i}y_{j}x_{i}^{T}x_{j} \bigg]$\\$s.t. \sum_{i=1}^{8}a_{i}y_{i} = 0, a_{i} \geq 0$
\\By using scikit-learn library, the optimal $\alpha$ is
\begin{align*}
\alpha_{1} = 0.03172284, \alpha_{2} = 0, \alpha_{3} = 0.1360743 , \alpha_{4} = 0,\\ \alpha_{5} = 0, \alpha_{6} = 0, \alpha_{7} = 0, \alpha_{8} = -0.16779714\\
\text{where } \alpha_{1}+\alpha_{2}+\alpha_{3}+\alpha_{4}+\alpha_{5}+\alpha_{6}+\alpha_{7}+\alpha_{8} = 0
\end{align*}
(The library calculated $\alpha_{i} \leftarrow y_{i}\alpha_{i}$,\\
$ \alpha_{8}\text{ should be } 0.16779714 \text{ if following } \alpha_{i} \geq 0$)\\
The support vector is $\bigg\{\begin{bmatrix}
6\\-8
\end{bmatrix},\begin{bmatrix}
9\\-8.5
\end{bmatrix},\begin{bmatrix}
9\\-5
\end{bmatrix}\bigg\}$\\
$\textbf{w}$ is $\begin{bmatrix}
-0.09516853\\-0.57142857
\end{bmatrix}$
\begin{align*}
b = \frac{1}{\mid S\mid} \sum_{s\in S}(\frac{1}{y_{s}} - w^{T}x_{s}) = -3.000556512
\end{align*}\\
We can get the hyperplane: \\$\begin{bmatrix}
-0.09516853\\-0.57142857
\end{bmatrix}x - 3.000556512 = 0$\\[0.1in]
b) For all test case predicted result $y_{i}$ indexed by $i$:\\
$\begin{cases}
y_{i} = -1 \text{ if   } 
\begin{bmatrix}-0.09516853\\-0.57142857
\end{bmatrix}^{T}x_{i}- 3.000556512 < 0\\
y_{i} = 1 \text{ if   } 
\begin{bmatrix}-0.09516853\\-0.57142857
\end{bmatrix}^{T}x_{i}- 3.000556512 > 0\end{cases}\\
$\\
The prediction obtained is:\\
$y_{1} = 1, y_{2} = 1, y_{3} = 1, y_{4} = 1, y_{5} = -1, y_{6} = -1, y_{7} = -1, y_{8} = -1$\\[0.1in]
c) Removing the 2nd data point in training set will \textbf{NOT} change the optimal hyperplane, but removing the 8th one \textbf{WILL} change it. Because 2nd one is \textbf{NOT} the support vectors, but 8th one \textbf{IS}.\\
\newpage
\newgeometry{top=0.5in, bottom=1in, left=0.5in, right=0.5in}
\begin{wrapfigure}[13]{r}{0.5\textwidth}
\includegraphics[scale=0.5]{CSCI3230Assg2Q2Train}\\
\includegraphics[scale=0.5]{CSCI3230Assg2Q2Test}\\
\includegraphics[scale=0.5]{CSCI3230Assg2Q3I1}\\
\includegraphics[scale=0.5]{CSCI3230Assg2Q3I2}\\
\end{wrapfigure}
2) Polynomial kernel is used to be the kernel function since the positive cases are centralized like a circle and the negative cases are surrounding the positive result. The degree chosen for the polynomial kernel is 2 but not higher value is to prevent overfitting. (Accuracy of the model is  92\%)\\[0.2in]
See attached file \textit{CSCI3230Assg2Q2.py} for coding details.\\[3.2in]
3a) By calculating the distance between the initial cluster points and the data given, the data points will be put into the closest cluster centroid by calculating \\$\sqrt{(data_{x} - centroid_{x})^{2} + (data_{y} - centroid_{y})^{2}}$\\So from the Assign Point Cluster Figure,\\
Cluster center (5, 4): a, b, c, d, e, f, g, h, i, j, k, l\\
Cluster center (12, 6): m, n, o, p, q, r, s, t, u, v, w, x\\
New centroid for (5, 4) \\= $(\frac{2+3+3+5+5+5+6+6+6+7+7+8}{12}, \frac{4+4+3+8+6+4++7+5+4+4+3+2}{12})\\=(5.25, 4.5)$\\
New centroid for (12, 6) \\= $(\frac{10+10+10+11+11+12+13+13+14+15+15+9}{12},\\ \frac{8+7+6+8+5+7+7+6+6+5+4+4}{12})\\=(11.916667, 6.083333)$\newpage b) Consider the following table, all the point that having neighbourhood relationship will be marked as -1,\\
\begin{table}[h]
\begin{tabular}{|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|}
\hline
 & a  & b  & c  & d  & e  & f  & g  & h  & i  & j  & k  & l  & m  & n  & o  & p  & q  & r  & s  & t  & u  & v  & w  & x  \\ \hline
a & -1 & -1 & -1 &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
b & -1 & -1 & -1 &    &    & -1 &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
c & -1 & -1 & -1 &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
d &    &    &    & -1 & -1 &    & -1 &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
e &    &    &    & -1 & -1 & -1 & -1 & -1 &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
f &    & -1 &    &    & -1 & -1 &    & -1 & -1 & -1 &    &    &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
g &    &    &    & -1 & -1 &    & -1 & -1 &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
h &    &    &    &    & -1 & -1 & -1 & -1 & -1 & -1 &    &    &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
i &    &    &    &    &    & -1 &    & -1 & -1 & -1 & -1 &    &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
j &    &    &    &    &    & -1 &    & -1 & -1 & -1 & -1 &    &    &    &    &    &    &    &    &    &    &    &    & -1 \\ \hline
k &    &    &    &    &    &    &    &    & -1 & -1 & -1 & -1 &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
l &    &    &    &    &    &    &    &    &    &    & -1 & -1 &    &    &    &    &    &    &    &    &    &    &    &    \\ \hline
m &    &    &    &    &    &    &    &    &    &    &    &    & -1 & -1 & -1 & -1 &    &    &    &    &    &    &    &    \\ \hline
n &    &    &    &    &    &    &    &    &    &    &    &    & -1 & -1 & -1 & -1 &    & -1 &    &    &    &    &    &    \\ \hline
o &    &    &    &    &    &    &    &    &    &    &    &    & -1 & -1 & -1 &    & -1 &    &    &    &    &    &    &    \\ \hline
p &    &    &    &    &    &    &    &    &    &    &    &    & -1 & -1 &    & -1 &    & -1 &    &    &    &    &    &    \\ \hline
q &    &    &    &    &    &    &    &    &    &    &    &    &    &    & -1 &    & -1 &    &    &    &    &    &    &    \\ \hline
r &    &    &    &    &    &    &    &    &    &    &    &    &    & -1 &    & -1 &    & -1 & -1 & -1 &    &    &    &    \\ \hline
s &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    & -1 & -1 & -1 & -1 &    &    &    \\ \hline
t &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    & -1 & -1 & -1 & -1 &    &    &    \\ \hline
u &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    & -1 & -1 & -1 & -1 &    &    \\ \hline
v &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    & -1 & -1 & -1 &    \\ \hline
w &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    &    & -1 & -1 &    \\ \hline
x &    &    &    &    &    &    &    &    &    & -1 &    &    &    &    &    &    &    &    &    &    &    &    &    & -1 \\ \hline
\end{tabular}
\end{table}\\
By scanning each rows, if Sum of that row $\leq -3$, it will be a core point. Therefore,\\
Core points: a, b, c, d, e, f, g, h, i, j, k, m, n, o, p, r, s, t, u, v\\[0.1in]
c) Yes, the intermediate points on the chain is $u \leftarrow t \leftarrow r \leftarrow n \leftarrow o$.\\[0.1in]
\begin{wrapfigure}[12]{o}{0.5\textwidth}
\includegraphics[scale=0.5]{CSCI3230Assg2Q3d2}
\end{wrapfigure} d) The right hand side shown the points processed by DBSCAN model, which:\\
Red color represents the Cluster 1: a, b, c, d, e, f, g, h, i, j, k, l, x;\\
Blue color represents the Cluster 2: m, n, o, p, q, r, s, t, u, v, w\\
Reminded that there is \textbf{NO noise points}.
\newpage
4) For \textbf{MIN distance},\\
\begin{align*}
M_{min} &= \bordermatrix{~ & p1 & p2 & p3 & p4 & p5 \cr
              p1 & 0 & - & - & - & - \cr
              p2 & 0.9 & 0 & - & - & - \cr
              p3 & 0.59 & 0.36 & 0 & - & - \cr
              p4 & 0.45 & 0.53 & 0.56 & 0 & - \cr
              p5 & 0.65 & 0.02 & 0.15 & 0.24 & 0 \cr} \Rightarrow \text{pick p2, p5 = 0.02 because they are minimum}\\[0.1in]
&\Rightarrow \bordermatrix{~ & p25 & p1 & p3 & p4 \cr
              p25 & 0 & - & - & - \cr
              p1 & 0.45 & 0 & - & - \cr
              p3 & 0.15 & 0.59 & 0 & - \cr
              p4 & 0.24 & 0.45 & 0.56 & 0 \cr} \Rightarrow \text{pick p25, p3 = 0.15 because they are minimum}\\[0.1in]
&\Rightarrow \bordermatrix{~ & p253 & p1 & p4 \cr
              p253 & 0 & - & - \cr
              p1 & 0.45 & 0 & - \cr
              p4 & 0.24 & 0.59 & 0 \cr} \Rightarrow \text{pick p253, p4 = 0.24 because they are minimum}\\[0.1in]
&\Rightarrow \bordermatrix{~ & p2534 & p1 \cr
              p2534 & 0 & - \cr
              p1 & 0.45 & 0 \cr} \Rightarrow \text{pick p2534, p1 = 0.45 because they are minimum}\\
\end{align*}
The dendrogram is shown below:\\
\includegraphics[scale=0.5]{CSCI3230Q4min}\\\newpage
For \textbf{MAX distance},\\
\begin{align*}
M_{max} &= \bordermatrix{~ & p1 & p2 & p3 & p4 & p5 \cr
              p1 & 0 & - & - & - & - \cr
              p2 & 0.9 & 0 & - & - & - \cr
              p3 & 0.59 & 0.36 & 0 & - & - \cr
              p4 & 0.45 & 0.53 & 0.56 & 0 & - \cr
              p5 & 0.65 & 0.02 & 0.15 & 0.24 & 0 \cr} \Rightarrow \text{pick p2, p5 = 0.02 because they are minimum}\\[0.1in]
&\Rightarrow \bordermatrix{~ & p25 & p1 & p3 & p4 \cr
              p25 & 0 & - & - & - \cr
              p1 & 0.9 & 0 & - & - \cr
              p3 & 0.36 & 0.59 & 0 & - \cr
              p4 & 0.53 & 0.45 & 0.56 & 0 \cr} \Rightarrow \text{pick p25, p3 = 0.36 because they are minimum}\\[0.1in]
&\Rightarrow \bordermatrix{~ & p253 & p1 & p4 \cr
              p253 & 0 & - & - \cr
              p1 & 0.9 & 0 & - \cr
              p4 & 0.56 & 0.45 & 0 \cr} \Rightarrow \text{pick p1, p4 = 0.45 because they are minimum}\\[0.1in]
&\Rightarrow \bordermatrix{~ & p253 & p14 \cr
              p253 & 0 & - \cr
              p14 & 0.9 & 0 \cr} \Rightarrow \text{pick p253, p14 = 0.9 because they are minimum}\\
\end{align*}
The dendrogram is shown below:\\
\includegraphics[scale=0.5]{CSCI3230Q4max}
\end{document}